# Deployment do Nginx
apiVersion: apps/v1
kind: Deployment
metadata:
  name: nginx-deployment
spec:
  replicas: 2
  selector:
    matchLabels:
      app: nginx
  template:
    metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx:latest
        ports:
        - containerPort: 80  # A porta interna no container Nginx

---
# Service do Nginx
apiVersion: v1
kind: Service
metadata:
  name: nginx-service
spec:
  selector:
    app: nginx
  ports:
  - protocol: TCP
    port: 8085        # Porta exposta no Kubernetes (pode ser acessada externamente)
    targetPort: 80     # Porta interna no container
  type: LoadBalancer  # Tipo LoadBalancer para expor o serviço externamente

---
# Configuração do K3D (com bind de porta no LoadBalancer)
apiVersion: k3d.io/v1alpha3
kind: K3dCluster   # Alterado de "Cluster" para "K3dCluster"
metadata:
  name: meucluster
spec:
  servers: 3
  agents: 3
  ports:
    - port: "8080:30000@loadbalancer"  # Bind da porta 8080 do host para a porta 30000 no load balancer
